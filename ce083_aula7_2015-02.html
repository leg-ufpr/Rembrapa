<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">



<title></title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<script src="libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="libs/tocify-1.9.1/jquery.tocify.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="libs/highlight/default.css"
      type="text/css" />
<script src="libs/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>




</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>

<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script src="libs/navigation-1.0/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<script src="libs/navigation-1.0/codefolding.js"></script>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>




<script>
$(document).ready(function ()  {
    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: "h1.title, .toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = false;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.9em;
  padding-left: 5px;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
  padding-left: 10px;
}

</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">



<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">LEG</a>
      <!-- <a class="navbar-brand" href="#"> -->
      <!--   <img alt="LEG" src="img/leg.png"> -->
      <!-- </a> -->
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li><a href="index.html">Início</a></li>
        <li class="dropdown">
          <a href="authoring" class="dropdown-toggle"
          data-toggle="dropdown" role="button"
          aria-expanded="false">Sumário <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
             <li class="dropdown-header">Introdução</li>
            <li><a href="ce083_aula2_2015-02.html">Funções, objetos e
            classes</a></li>
            <li><a href="ce083_aula3_2015-02.html">Manipulação de
            objetos</a></li>
            <li><a href="ce083_aula4_2015-02.html">Entrada de
            dados</a></li>
            <li><a href="ce083_aula5_2015-02.html">Análise exploratória
                de dados</a></li>
             <li><a href="ce083_aula6_2015-02.html">Gráficos</a></li>
             <li><a href="ce083_aula7_2015-02.html">Probabilidade</a></li>
             <li class="divider"></li>
          </ul>
        </li>
      </ul>
      <div class="navbar-collapse collapse navbar-right" >
        <ul class="nav navbar-nav">
          <li><a class="btn btn-link" href="https://github.com/leg-ufpr/Rembrapa" role="button">
              <i class="fa fa-github"></i> GitHub </a>
          </li>
        </ul>
      </div><!--/.navbar-right -->
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="text-muted">Code</span> <span class="text-muted caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All</a></li>
</ul>
</div>


</div>


<div id="probabilidade-no-r" class="section level1">
<h1>Probabilidade no R</h1>
<div id="conceitos-basicos-sobre-distribuicoes-de-probabilidade" class="section level2">
<h2>Conceitos básicos sobre distribuições de probabilidade</h2>
<p>O objetivo desta sessão é mostrar o uso de funções do R em problemas de probabilidade. Exercícios que podem (e devem!) ser resolvidos analiticamente, serão utilizados para ilustrar o uso do programa e alguns de seus recursos para análises numéricas.</p>
<p>Os problemas desta sessão foram retirados do livro de Bussab e Morettin (2003).</p>
<div id="exemplo-1.-adaptado-de-bussab-e-morettin-pagina-166-exercicio-1" class="section level5">
<h5>Exemplo 1. (Adaptado de Bussab e Morettin, página 166, exercício 1)</h5>
<p>Dada a função</p>
<p><span class="math display">\[
\
  f(x) = \left\{ \begin{array}{ll}
      2 e^{-2x} &amp; \mbox{ , se $ \; x \geq 0$} \cr
      0   &amp; \mbox{ , se  $ \; x &lt; 0$}
    \end{array} \right.
\
\]</span></p>
<ol style="list-style-type: lower-alpha">
<li>Mostre que está função é uma f.d.p.</li>
<li>Calcule a probabilidade de que <span class="math inline">\(X &gt; 1\)</span></li>
<li>calcule a probabilidade de que <span class="math inline">\(0.2 &lt; X &lt; 0.8\)</span></li>
</ol>
<p>Para ser f.d.p. a função não deve ter valores negativos e deve integrar 1 em seu domínio. Vamos começar definindo esta função como uma <em>função</em> no R para qual daremos o nome de <code>f1</code>.</p>
<pre class="r"><code>f1 &lt;- function(x){
    fx &lt;- ifelse(x &lt; 0, 0, 2 * exp(-2 * x))
    return(fx)
}</code></pre>
<p>A seguir fazemos o gráfico da função. Como a função tem valores positivos para <span class="math inline">\(x\)</span> no intervalo de zero a infinito, temos que definir um limite em <span class="math inline">\(x\)</span> até onde vai o gráfico da função. Vamos achar este limite tentando vários valores, conforme mostram os comandos abaixo.</p>
<pre class="r"><code>par(mfrow = c(2, 2))
plot(f1)
plot(f1, from = 0, to = 5)
plot(f1, from = 0, to = 7)
plot(f1, from = 0, to = 10)
par(mfrow = c(1, 1))</code></pre>
<p><img src="ce083_aula7_2015-02_files/figure-html/unnamed-chunk-2-1.png" title="" alt="" width="672" /></p>
<p>Para verificar que a a integral da função é igual a 1 podemos usar a função <code>integrate()</code>, que efetua integração numérica. A função recebe como argumentos o objeto com a função a ser integrada e os limites de integração. Neste exemplo o objeto é <code>f1</code> definido acima, e o domínio da função é <span class="math inline">\([0, \infty]\)</span>. A saída da função mostra o valor da integral acima, e o erro máximo da aproximação numérica.</p>
<pre class="r"><code>integrate(f1, lower = 0, upper = Inf)</code></pre>
<pre><code>## 1 with absolute error &lt; 5e-07</code></pre>
<p>Para fazer cálculos pedidos nos itens (b) e (c) lembramos que a probabilidade é dada pela área sob a curva da função no intervalo pedido. Desta forma as soluções seriam dadas pelas expressões</p>
<p><span class="math display">\[
\begin{eqnarray*}
 p_b &amp; = &amp; P(X &gt; 1) = \int_1^\infty f(x) dx = \int_1^\infty 2\,e^{-2x} dx \\
 p_c &amp; = &amp; P(0,2 &lt; X &lt; 0,8) = \int_{0,2}^{0,8} f(x) dx = \int_{0.2}^{0.8} 2\,e^{-2x} dx \,
\end{eqnarray*} 
\]</span></p>
<p>cuja representação gráfica é mostrada na abaixo.</p>
<p>Os comandos a seguir mostram como fazer o gráfico dessas funções. O comando <code>plot()</code> desenha o gráfico principal, e para destacar as áreas que correspondem às probabilidades pedidas vamos usar a função <code>polygon()</code>. Esta função adiciona a um gráfico um polígono que é definido pelas coordenadas de seus vértices. Para sombrear a área usa-se o argumento <code>density</code>. Finalmente, para escrever um texto no gráfico usamos a função <code>text()</code> com as coordenadas de posição do texto.</p>
<pre class="r"><code>plot(f1, from = 0, to = 5)
polygon(x = c(1, seq(1, 5, length.out = 20)),
        y = c(0, f1(seq(1, 5,length.out = 20))),
        density = 10) 
polygon(x = c(0.2, seq(0.2, 0.8, length.out = 20), 0.8),
        y = c(0, f1(seq(0.2, 0.8, length.out = 20)), 0),
        col = &quot;gray&quot;) 
text(x = c(1.2, 0.5), y = c(0.1, 0.2),
     c(expression(p[b], p[c])))</code></pre>
<p><img src="ce083_aula7_2015-02_files/figure-html/unnamed-chunk-4-1.png" title="" alt="" width="672" /></p>
<p>E para obter as probabilidades pedidas usamos <code>integrate()</code>.</p>
<pre class="r"><code>integrate(f1, lower = 1, upper = Inf)</code></pre>
<pre><code>## 0.1353353 with absolute error &lt; 2.1e-05</code></pre>
<pre class="r"><code>integrate(f1, lower = 0.2, upper = 0.8)</code></pre>
<pre><code>## 0.4684235 with absolute error &lt; 5.2e-15</code></pre>
</div>
</div>
<div id="distribuicoes-de-probabilidade" class="section level2">
<h2>Distribuições de Probabilidade</h2>
<p>O R inclui funcionalidade para operações com distribuições de probabilidades. Para cada distribuição há 4 operações básicas indicadas pelas letras:</p>
<ul>
<li><code>d</code> calcula a densidade de probabilidade <span class="math inline">\(f(x)\)</span> no ponto</li>
<li><code>p</code> calcula a função de probabilidade acumulada <span class="math inline">\(F(x)\)</span> no ponto</li>
<li><code>q</code> calcula o quantil correspondente a uma dada probabilidade</li>
<li><code>r</code> retira uma amostra aleatória da distribuição</li>
</ul>
<p>Para usar os funções deve-se combinar uma das letras acima com uma abreviatura do nome da distribuição. Por exemplo, para calcular probabilidades usamos: <code>pnorm()</code> para normal, <code>pexp()</code> para exponencial, <code>pbinom()</code> para binomial, <code>ppois()</code> para Poisson e assim por diante.</p>
<p>Vamos ver com mais detalhes algumas distribuições de probabilidades.</p>
<div id="distribuicao-normal" class="section level3">
<h3>Distribuição Normal</h3>
<p>A funcionalidade para distribuição normal é implementada por argumentos que combinam as letras acima com o termo <code>norm</code>. Vamos ver alguns exemplos com a distribuição normal padrão. Por <code>default</code> as funções assumem a distribuição normal padrão <span class="math inline">\(N(\mu=0, \sigma^2=1)\)</span>.</p>
<pre class="r"><code>dnorm(-1)</code></pre>
<pre><code>## [1] 0.2419707</code></pre>
<pre class="r"><code>pnorm(-1)</code></pre>
<pre><code>## [1] 0.1586553</code></pre>
<pre class="r"><code>qnorm(0.975)</code></pre>
<pre><code>## [1] 1.959964</code></pre>
<pre class="r"><code>rnorm(10)</code></pre>
<pre><code>##  [1] -0.50219235  0.13153117 -0.07891709  0.88678481  0.11697127
##  [6]  0.31863009 -0.58179068  0.71453271 -0.82525943 -0.35986213</code></pre>
<p>O primeiro valor acima, de <code>dnorm(-1)</code>, corresponde ao valor da densidade da normal</p>
<p><span class="math display">\[
f(x) = \frac{1}{\sigma\sqrt{2 \pi}}\exp \left[ -\frac{1}{2}
    \left( \frac{x - \mu}{\sigma} \right)^2 \right]
\]</span></p>
<p>com parâmetros <span class="math inline">\((\mu=0, \sigma^2=1)\)</span> no ponto <span class="math inline">\(x = -1\)</span>. Portanto, o mesmo valor seria obtido substituindo <span class="math inline">\(x\)</span> por <span class="math inline">\(-1\)</span> na expressão da normal:</p>
<pre class="r"><code>mu &lt;- 0
sigma &lt;- 1
x &lt;- -1
(1/(sigma * sqrt(2*pi))) * exp((-1/2) * ((x - mu)/sigma)^2)</code></pre>
<pre><code>## [1] 0.2419707</code></pre>
<p>A função <code>pnorm(-1)</code> calcula a probabilidade <span class="math inline">\(P(X \leq -1)\)</span>. O comando <code>qnorm(0.975)</code> calcula o valor de <span class="math inline">\(a\)</span> tal que <span class="math inline">\(P(X \leq a) = 0.975\)</span>. Finalmente, o comando <code>rnorm(10)</code> gera uma amostra aleatória de 10 elementos da normal padrão. Note que os valores que você obtém rodando este comando podem ser diferentes dos mostrados acima.</p>
<p>As funções acima possuem argumentos adicionais, para os quais valores padrão (<em>default</em>) foram assumidos, e que podem ser modificados. Usamos <code>args()</code> para ver os argumentos de uma função e <code>help()</code> para visualizar a documentação detalhada:</p>
<pre class="r"><code>args(rnorm)</code></pre>
<pre><code>## function (n, mean = 0, sd = 1) 
## NULL</code></pre>
<p>As funções relacionadas à distribuição normal possuem os argumentos <code>mean</code> e <code>sd</code> para definir média e desvio padrão da distribuição que podem ser modificados como nos exemplos a seguir. Note nestes exemplos que os argumentos podem ser passados de diferentes formas.</p>
<pre class="r"><code>qnorm(0.975, mean = 100, sd = 8)</code></pre>
<pre><code>## [1] 115.6797</code></pre>
<pre class="r"><code>qnorm(0.975, m = 100, s = 8)</code></pre>
<pre><code>## [1] 115.6797</code></pre>
<pre class="r"><code>qnorm(0.975, 100, 8)</code></pre>
<pre><code>## [1] 115.6797</code></pre>
<blockquote>
<p><strong>Observação</strong>: na segunda linha de comando acima, foi utilizado um recurso do R chamado <em>partial matching</em>. Isso significa que nomes de argumentos de funções podem ser especificados pelo seu nome parcial, ou seja, com apenas o início do nome, desde que não haja ambiguação com outros argumentos.</p>
</blockquote>
<p>Para informações mais detalhadas pode-se usar <code>help()</code>. O comando</p>
<pre class="r"><code>help(rnorm)</code></pre>
<p>irá exibir em uma janela a documentação da função que pode também ser chamada com <code>?rnorm</code>. Note que ao final da documentação são apresentados exemplos que podem ser rodados pelo usuário e que auxiliam na compreensão da funcionalidade. Note também que as 4 funções relacionadas à distribuição normal são documentadas conjuntamente, portanto <code>help(rnorm)</code>, <code>help(qnorm)</code>, <code>help(dnorm)</code> e <code>help(pnorm)</code> irão exibir a mesma documentação.</p>
<p>Cálculos de probabilidades usuais, para os quais utilizávamos tabelas estatísticas podem ser facilmente obtidos como no exemplo a seguir.</p>
<p>Seja <span class="math inline">\(X\)</span> uma VA com distribuição <span class="math inline">\(N(100, 100)\)</span>. Calcular as probabilidades:</p>
<ul>
<li><span class="math inline">\(P[X &lt; 95]\)</span></li>
<li><span class="math inline">\(P[90 &lt; X &lt; 110]\)</span></li>
<li><span class="math inline">\(P[X &gt; 95]\)</span></li>
</ul>
<p>Calcule estas probabilidades de forma usual, usando a tabela da normal. Depois compare com os resultados fornecidos pelo R. Os comandos do para obter as probabilidades pedidas são:</p>
<pre class="r"><code>## P[X &lt; 95]
pnorm(95, 100, 10)</code></pre>
<pre><code>## [1] 0.3085375</code></pre>
<pre class="r"><code>## P[90 &lt; X &lt; 110]
pnorm(110, 100, 10) - pnorm(90, 100, 10)</code></pre>
<pre><code>## [1] 0.6826895</code></pre>
<pre class="r"><code>## P[X &gt; 95] = 1 - P[X &lt; 95]
1 - pnorm(95, 100, 10)</code></pre>
<pre><code>## [1] 0.6914625</code></pre>
<pre class="r"><code>pnorm(95, 100, 10, lower.tail = FALSE) # melhor</code></pre>
<pre><code>## [1] 0.6914625</code></pre>
<p>Note que a última probabilidade foi calculada de duas formas diferentes, a segunda usando o argumento <code>lower.tail</code> que implementa um algorítmo de cálculo de probabilidades mais estável numericamente, e essa forma é preferida no lugar de usar o complementar.</p>
<p>A seguir vamos ver comandos para fazer gráficos de distribuições de probabilidade. Vamos fazer gráficos de funções de densidade e de probabilidade acumulada. Estude cuidadosamente os comandos abaixo e verifique os gráficos por eles produzidos.</p>
<p>A figura abaixo mostra gráficos da densidade (esquerda) e probabilidade acumulada (direita) da normal padrão, produzidos com os comandos a seguir. Para fazer o gráfico consideramos valores de <span class="math inline">\(X\)</span> entre -3 e 3 que correspondem a +/- três desvios padrões da média, faixa que concentra 99,73% da massa de probabilidade da distribuição normal.</p>
<pre class="r"><code>par(mfrow = c(1, 2))
plot(dnorm, from = -3, to = 3)
plot(pnorm, from = -3, to = 3)
par(mfrow = c(1, 1))</code></pre>
<p><img src="ce083_aula7_2015-02_files/figure-html/unnamed-chunk-12-1.png" title="" alt="" width="672" /></p>
<blockquote>
<p>VEJA a página de ajuda da função <code>plot.function()</code> para entender os argumentos e demais funcionalidades desta função gráfica para plotar gráficos de funções</p>
</blockquote>
<p>A seguinte figura mostra gráficos da densidade (esquerda) e probabilidade acumulada (direita) da <span class="math inline">\(N(100, 64)\)</span>. Para fazer estes gráficos tomamos uma sequência de valores de <span class="math inline">\(X\)</span> entre 70 e 130 e para cada um deles calculamos o valor das funções <span class="math inline">\(f(x)\)</span> e <span class="math inline">\(F(x)\)</span>. Depois unimos os pontos <span class="math inline">\((x,f(x))\)</span> em um gráfico e <span class="math inline">\((x,F(x))\)</span> no outro.</p>
<pre class="r"><code>par(mfrow = c(1, 2))
x &lt;- seq(70, 130, length.out = 100)
fx &lt;- dnorm(x, 100, 8)
plot(x, fx, type = &quot;l&quot;)
Fx &lt;- pnorm(x, 100, 8)
plot(x, Fx, type = &quot;l&quot;)
par(mfrow = c(1, 1))</code></pre>
<p><img src="ce083_aula7_2015-02_files/figure-html/unnamed-chunk-13-1.png" title="" alt="" width="672" /></p>
<p>Note que, alternativamente, os mesmos gráficos poderiam ser produzidos com os comandos a seguir, onde fazemos usa da função <code>plot.function()</code>.</p>
<pre class="r"><code>par(mfrow = c(1, 2))
plot(function(x) dnorm(x, 100, 8), from = 70, to = 130)
plot(function(x) pnorm(x, 100, 8), from = 70, to = 130)
par(mfrow = c(1, 1))</code></pre>
<p><img src="ce083_aula7_2015-02_files/figure-html/unnamed-chunk-14-1.png" title="" alt="" width="672" /></p>
<p>Comandos usuais do R podem ser usados para modificar a aparência dos gráficos. Por exemplo, podemos incluir títulos e mudar texto dos eixos conforme mostrado abaixo.</p>
<pre class="r"><code>plot(dnorm, from = -3, to = 3,
     xlab = &quot;Valores de X&quot;,
     ylab = &quot;Densidade de probabilidade&quot;)
title(&quot;Distribuicão Normal\nX ~ N(100, 64)&quot;)</code></pre>
<p><img src="ce083_aula7_2015-02_files/figure-html/unnamed-chunk-15-1.png" title="" alt="" width="672" /></p>
<p>Os demais comandos abaixo mostram como colocar diferentes densidades em um mesmo gráfico, usando o argumento <code>add = TRUE</code>.</p>
<pre class="r"><code>plot(function(x) dnorm(x, 100, 8), 60, 140, ylab = &#39;f(x)&#39;)
plot(function(x) dnorm(x, 90, 8), 60, 140, add = TRUE, col = 2)
plot(function(x) dnorm(x, 100, 15), 60, 140, add = TRUE, col = 3)
legend(120, 0.05, fill = 1:3,
       legend = c(&quot;N(100,64)&quot;, &quot;N(90,64)&quot;, &quot;N(100,225)&quot;))</code></pre>
<p><img src="ce083_aula7_2015-02_files/figure-html/unnamed-chunk-16-1.png" title="" alt="" width="672" /></p>
</div>
<div id="distribuicao-binomial" class="section level3">
<h3>Distribuição Binomial</h3>
<p>Cálculos para a distribuição binomial são implementados combinando as letras básicas vistas acima com o termo <code>binom</code>. Vamos primeiro investigar argumentos e documentação com <code>args()</code> e <code>help()</code>.</p>
<pre class="r"><code>args(dbinom)</code></pre>
<pre><code>## function (x, size, prob, log = FALSE) 
## NULL</code></pre>
<pre class="r"><code>help(dbinom)</code></pre>
<p>Seja <span class="math inline">\(X\)</span> uma VA com distribuição Binomial, com <span class="math inline">\(n=10\)</span> e <span class="math inline">\(p=0.35\)</span>. Vamos ver os comandos do R para:</p>
<ul>
<li>Fazer o gráfico da função de densidade</li>
<li>Idem para a função de probabilidade</li>
<li>Calcular <span class="math inline">\(P[X = 7]\)</span></li>
<li>Calcular <span class="math inline">\(P[X \leq 7]\)</span></li>
<li>Calcular <span class="math inline">\(P[X &gt; 7]\)</span></li>
<li>Calcular <span class="math inline">\(P[3 &lt; X \leq 6]\)</span></li>
</ul>
<p>Note que sendo uma distribuição discreta de probabilidades os gráficos são diferentes dos obtidos para distribuição normal e os cálculos de probabilidades devem considerar as probabilidades nos pontos. Os gráficos das funções de densidade e probabilidade são mostrados abaixo.</p>
<pre class="r"><code>par(mfrow = c(1, 2))
x &lt;- 0:10
fx &lt;- dbinom(x, size = 10, prob = 0.35)
plot(x, fx, type = &quot;h&quot;)
Fx &lt;- pbinom(x, size = 10, prob = 0.35)
plot(x, Fx, type = &quot;s&quot;)
par(mfrow = c(1, 1))</code></pre>
<p><img src="ce083_aula7_2015-02_files/figure-html/unnamed-chunk-19-1.png" title="" alt="" width="672" /></p>
<p>As probabilidades pedidas são obtidas com os comandos a seguir.</p>
<pre class="r"><code>## P[X = 7]
dbinom(7, size = 10, prob = 0.35)</code></pre>
<pre><code>## [1] 0.02120302</code></pre>
<pre class="r"><code>## P[X &lt;= 7]
pbinom(7, size = 10, prob = 0.35)</code></pre>
<pre><code>## [1] 0.9951787</code></pre>
<pre class="r"><code># OU
sum(dbinom(0:7, size = 10, prob = 0.35))</code></pre>
<pre><code>## [1] 0.9951787</code></pre>
<pre class="r"><code>## P[X &gt; 7]
1 - pbinom(7, size = 10, prob = 0.35)</code></pre>
<pre><code>## [1] 0.004821265</code></pre>
<pre class="r"><code>pbinom(7, size = 10, prob = 0.35, lower.tail = FALSE) # melhor</code></pre>
<pre><code>## [1] 0.004821265</code></pre>
<pre class="r"><code>## P[3 &lt; X &lt;= 6]
pbinom(6, 10, 0.35) - pbinom(3, 10, 0.35)</code></pre>
<pre><code>## [1] 0.4601487</code></pre>
<pre class="r"><code># OU
sum(dbinom(4:6, 10, 0.35))</code></pre>
<pre><code>## [1] 0.4601487</code></pre>
</div>
<div id="distribuicao-de-poisson" class="section level3">
<h3>Distribuição de Poisson</h3>
<p><strong>Definição:</strong> Seja um experimento realizado nas seguintes condições: i. As ocorrências são independentes ii. As ocorrências são aleatórias iii. A variável aleatória <span class="math inline">\(X\)</span> é o número de ocorrências de um evento <strong>ao longo de algum intervalo</strong>} (de tempo ou espaço)</p>
<p>Denominamos esse experimento de <strong>processo de Poisson</strong>. Vamos associar a V.A. <span class="math inline">\(X\)</span> o número de ocorrências em um intervalo. Portanto <span class="math inline">\(X\)</span> poderá assumir os valores <span class="math inline">\(0, 1, \ldots,\)</span> (sem limite superior).</p>
<p>A distribuição de Poisson é utilizada para descrever a probabilidade do <strong>número de ocorrências</strong> em um <strong>intervalo contínuo</strong> (de tempo ou espaço). No caso da distribuição binomial, a variável de interesse era o número de sucessos em um <strong>intervalo discreto</strong> (<span class="math inline">\(n\)</span> ensaios de Bernoulli). A unidade de medida (tempo ou espaço) é uma variável contínua, mas a <em>variável aleatória</em>, o <strong>número de ocorrências</strong>}, é discreta.</p>
<p>Uma V.A. <span class="math inline">\(X\)</span> segue o modelo de Poisson se surge a partir de um processo de Poisson, e sua <strong>função de probabilidade</strong>} for dada por</p>
<p><span class="math display">\[
    P[X = x] = \frac{e^{-\mu} \mu^x}{x!}, \quad \quad x = 0, 1, \ldots
\]</span></p>
<p>onde</p>
<p><span class="math display">\[
    \mu = \lambda \cdot t
\]</span></p>
<p>O parâmetro <span class="math inline">\(\mu\)</span> indica a taxa de ocorrência (<span class="math inline">\(\lambda\)</span>) por unidade de medida (<span class="math inline">\(t\)</span>), ou seja,</p>
<p><span class="math display">\[
    \lambda = \text{taxa de ocorrência} \quad \text{e} \quad t =
    \text{intervalo de tempo ou espaço}
\]</span></p>
<ul>
<li>Notação: <span class="math inline">\(X \sim \text{Pois}(\mu)\)</span></li>
<li>Esperança e variância: <span class="math inline">\(\text{E}(X) = \mu = \text{Var}(X)\)</span></li>
</ul>
<p>Alguns exemplos de gráficos da distribuição de Poisson com diferentes valores do parâmetro <span class="math inline">\(\mu\)</span>.</p>
<pre class="r"><code>par(mfrow=c(2,2))
plot(0:30, dpois(x = 0:30, lambda = 1), type = &quot;h&quot;,
     xlab = &quot;X&quot;, ylab = &quot;P[X = x]&quot;, main = expression(mu == 1),
     ylim = c(0,.4))
plot(0:30, dpois(x = 0:30, lambda = 5), type = &quot;h&quot;,
     xlab = &quot;X&quot;, ylab = &quot;P[X = x]&quot;, main = expression(mu == 5),
     ylim = c(0,.4))
plot(0:30, dpois(x = 0:30, lambda = 10), type = &quot;h&quot;,
     xlab = &quot;X&quot;, ylab = &quot;P[X = x]&quot;, main = expression(mu == 10),
     ylim = c(0,.4))
plot(0:30, dpois(x = 0:30, lambda = 15), type = &quot;h&quot;,
     xlab = &quot;X&quot;, ylab = &quot;P[X = x]&quot;, main = expression(mu == 15),
     ylim = c(0,.4))</code></pre>
<p><img src="ce083_aula7_2015-02_files/figure-html/unnamed-chunk-21-1.png" title="" alt="" width="672" /></p>
<ul>
<li><strong>Exemplo</strong>: As chamadas telefônicas chegam a uma delegacia de polícia à uma taxa de 8 chamadas por hora, em dias úteis.
<ol style="list-style-type: lower-alpha">
<li>Quantas chamadas de emergência são esperadas em um período de 15 minutos?</li>
<li>Qual a probabilidade de nenhuma chamada em um período de 15 minutos?</li>
<li>Qual a probabilidade de ocorrer pelo menos duas chamadas no período de 15 minutos?</li>
<li>Qual a probabilidade de ocorrer exatamente duas chamadas em 20 minutos?</li>
</ol></li>
</ul>
<pre class="r"><code>## a) E(X) = mu = lambda . t
lambda &lt;- 8/60 # 8 chamadas/60 minutos
t &lt;- 15 # 15 minutos
(mu &lt;- lambda * t)</code></pre>
<pre><code>## [1] 2</code></pre>
<pre class="r"><code>## b) P[x = 0]
ppois(0, mu)</code></pre>
<pre><code>## [1] 0.1353353</code></pre>
<pre class="r"><code>dpois(0, mu)</code></pre>
<pre><code>## [1] 0.1353353</code></pre>
<pre class="r"><code>## c) P[X &gt;= 2] = 1 - P[X &lt; 2]
1 - ppois(1, mu)</code></pre>
<pre><code>## [1] 0.5939942</code></pre>
<pre class="r"><code>ppois(1, mu, lower.tail = FALSE)</code></pre>
<pre><code>## [1] 0.5939942</code></pre>
<pre class="r"><code>## d) P[X = 2]
t &lt;- 20
(mu &lt;- lambda * t)</code></pre>
<pre><code>## [1] 2.666667</code></pre>
<pre class="r"><code>dpois(2, mu)</code></pre>
<pre><code>## [1] 0.2470523</code></pre>
<ul>
<li><strong>Exemplo:</strong> Suponha que 150 erros de impressão são distribuídos aleatoriamente em um livro de 200 páginas. Encontre a probabilidade de que em 2 páginas contenham:
<ol style="list-style-type: lower-alpha">
<li>nenhum erro de impressão</li>
<li>três erros de impressão</li>
<li>um ou mais erros de impressão</li>
</ol></li>
</ul>
<pre class="r"><code>## lambda = taxa de ocorrência por página
lambda &lt;- 150/200
## intervalo de interesse
t &lt;- 2
## Parâmetro mu = lambda . t
(mu &lt;- lambda * t)</code></pre>
<pre><code>## [1] 1.5</code></pre>
<pre class="r"><code>## a) P[X = 0]
dpois(0, mu)</code></pre>
<pre><code>## [1] 0.2231302</code></pre>
<pre class="r"><code>## b) P[X = 3]
dpois(3, mu)</code></pre>
<pre><code>## [1] 0.1255107</code></pre>
<pre class="r"><code>## c) P[X &gt;= 1] = 1 - P[X &lt; 1]
1 - ppois(0, mu)</code></pre>
<pre><code>## [1] 0.7768698</code></pre>
<pre class="r"><code>ppois(0, mu, lower.tail = FALSE)</code></pre>
<pre><code>## [1] 0.7768698</code></pre>
</div>
<div id="distribuicao-uniforme" class="section level3">
<h3>Distribuição Uniforme</h3>
<div id="uniforme-continua" class="section level4">
<h4>Uniforme Contínua</h4>
<p>Para a distribuição uniforme <em>contínua</em> usa-se as funções <code>*unif()</code> onde <code>*</code> deve ser <span class="math inline">\(p\)</span>, <span class="math inline">\(q\)</span>, <span class="math inline">\(d\)</span> ou <span class="math inline">\(r\)</span> como mencionado anteriormente. Nos comandos a seguir inspecionamos os argumentos, sorteamos 5 valores da <span class="math inline">\(U(0,1)\)</span> e calculamos a probabilidade acumulada até 0,75.</p>
<p><code>r  args(runif)</code></p>
<p><code>## function (n, min = 0, max = 1)   ## NULL</code></p>
<p><code>r  runif(5)</code></p>
<p><code>## [1] 0.5358112 0.7108038 0.5383487 0.7489722 0.4201015</code></p>
<p><code>r  punif(0.75)</code></p>
<p><code>## [1] 0.75</code></p>
<p>Portanto, o <em>default</em> é uma distribuição uniforme no intervalo <span class="math inline">\([0,1]\)</span> e os argumentos opcionais são <code>min</code> e <code>max</code>. Por exemplo, para simular 5 valores de <span class="math inline">\(X \sim U(5, 20)\)</span> usamos:</p>
<pre class="r"><code>runif(5, min = 5, max = 20)</code></pre>
<pre><code>## [1]  7.571303 16.554524 18.229304 13.236451  9.165856</code></pre>
</div>
<div id="uniforme-discreta" class="section level4">
<h4>Uniforme Discreta</h4>
<p>Não há entre as funções básicas do R uma função específica para a distribuição uniforme discreta com opções de prefixos <span class="math inline">\(r,d,p\)</span> e <span class="math inline">\(d\)</span>, provavelmente devido a sua simplicidade, embora algumas outras funções possam ser usadas. Por exemplo para sortear números pode-se usar <code>sample()</code>, como no exemplo a seguir onde são sorteados 15 valores de uma uniforma discreta com valores (inteiros) entre 1 e 10 (<span class="math inline">\(X \sim U_d(1,10)\)</span>).</p>
<pre class="r"><code>sample(1:10, size = 15, replace = TRUE)</code></pre>
<pre><code>##  [1]  5 10  4 10  7  9  2  7 10  2  4  9  8  9  7</code></pre>
</div>
</div>
<div id="a-funcao-sample" class="section level3">
<h3>A função <code>sample()</code></h3>
<p>A função <code>sample()</code> <strong>não</strong> é restrita à distribuição uniforme discreta, podendo ser usada para sorteios, com ou sem reposição (argumento <code>replace</code>, que por padrão é <code>FALSE</code>, ou seja, sem reposição), com a possibilidade de associar diferentes probabilidades a cada elemento (argumento <code>prob</code>, que por padrão associa probabilidades iguais para todos os elementos).</p>
<pre class="r"><code>args(sample)</code></pre>
<pre><code>## function (x, size, replace = FALSE, prob = NULL) 
## NULL</code></pre>
<p>Vejamos alguns exemplos:</p>
<ul>
<li>Sorteio de 3 números entre os inteiros de 0 a 20</li>
</ul>
<pre class="r"><code>sample(0:20, size = 3)</code></pre>
<pre><code>## [1] 10 15 16</code></pre>
<ul>
<li>Sorteio de 5 números entre os elementos de um certo vetor <code>x</code></li>
</ul>
<pre class="r"><code>x &lt;- c(23, 34, 12, 22, 17, 28, 18, 19, 20, 13, 18)
sample(x, size = 5)</code></pre>
<pre><code>## [1] 12 22 18 34 19</code></pre>
<ul>
<li>Sorteio de 10 números entre os possíveis resultados do lançamento de um dado, com reposição</li>
</ul>
<pre class="r"><code>sample(1:6, size = 10, replace = TRUE)</code></pre>
<pre><code>##  [1] 2 4 2 1 2 4 2 3 4 6</code></pre>
<ul>
<li>Idem ao anterior, porém agora com a probabilidade de cada face proporcional ao valor da face.</li>
</ul>
<pre class="r"><code>sample(1:6, size = 10, replace = TRUE,  prob = 1:6)</code></pre>
<pre><code>##  [1] 4 5 5 5 5 6 4 5 5 4</code></pre>
<p>Este último exemplo ilustra ainda que os valores passados para o argumento <code>prob</code> não precisam ser probabilidades, são apenas entendidos como <strong>pesos</strong>. A própria função trata isto internamente fazendo a ponderação adequada.</p>
</div>
</div>
<div id="complementos-sobre-distribuicoes-de-probabilidade" class="section level2">
<h2>Complementos sobre distribuições de probabilidade</h2>
<p>Agora que já nos familiarizamos com o uso das distribuições de probabilidade vamos ver alguns detalhes adicionais sobre seu funcionamento.</p>
<div id="probabilidades-e-integrais" class="section level3">
<h3>Probabilidades e integrais</h3>
<p>A probabilidade de um evento em uma distribuição contínua é uma área sob a curva da distribuição. Vamos reforçar esta idéia revisitando um exemplo visto na distribuição normal.</p>
<p>Seja <span class="math inline">\(X\)</span> uma VA com distribuição <span class="math inline">\(N(100, 100)\)</span>. Para calcular a probabilidade <span class="math inline">\(P[X &lt; 95]\)</span> usamos o comando:</p>
<pre class="r"><code>pnorm(95, mean = 100, sd = 10)</code></pre>
<pre><code>## [1] 0.3085375</code></pre>
<p>Vamos agora “esquecer” o comando <code>pnorm()</code> e ver uma outra forma de resolver usando integração numérica. Lembrando que a normal tem a função de densidade dada por</p>
<p><span class="math display">\[
f(x) = \frac{1}{\sigma\sqrt{2 \pi}}\exp \left[ -\frac{1}{2}
    \left( \frac{x - \mu}{\sigma} \right)^2 \right]
\]</span></p>
<p>Podemos então definir uma função no R para calcular qualquer densidade em <span class="math inline">\(x\)</span></p>
<pre class="r"><code>fn &lt;- function(x, mu, sigma){
    (1/(sigma * sqrt(2*pi))) * exp((-1/2) * ((x - mu)/sigma)^2)
}</code></pre>
<p>Para obter o gráfico desta distribuição, usamos o fato que a maior parte da função está no intervalo entre a média +/- três desvios padrões, portanto entre 70 e 130. Podemos então fazer como nos comandos que se seguem. Para marcar no gráfico a área que corresponde a probabilidade pedida criamos um polígono com coordenadas <code>ax</code> e <code>ay</code> definindo o perímetro desta área.</p>
<pre class="r"><code>x &lt;- seq(70, 130, length.out = 200)
fx &lt;- fn(x, mu = 100, sigma = 10)
plot(x, fx, type = &quot;l&quot;)
ax &lt;- c(70, 70, x[x &lt; 95], 95, 95)
ay &lt;- c(0, fn(70, 100, 10), fx[x &lt; 95], fn(95, 100, 10),0)
polygon(ax, ay, density = 10)</code></pre>
<p><img src="ce083_aula7_2015-02_files/figure-html/unnamed-chunk-34-1.png" title="" alt="" width="672" /></p>
<p>Para calcular a área pedida sem usar a função <code>pnorm()</code> podemos usar a função de integração numérica. Note que esta função, diferentemente da <code>pnorm()</code> reporta ainda o erro de aproximação numérica.</p>
<pre class="r"><code>integrate(fn, mu = 100, sigma = 10, lower = -Inf, upper = 95)</code></pre>
<pre><code>## 0.3085375 with absolute error &lt; 2.1e-06</code></pre>
<p>Portanto para os demais ítens do problema, <span class="math inline">\(P[90 &lt; X &lt; 110]\)</span>, e <span class="math inline">\(P[X &gt; 95]\)</span> fazemos:</p>
<pre class="r"><code>integrate(fn, mu = 100, sigma = 10, lower = 90, upper = 110)</code></pre>
<pre><code>## 0.6826895 with absolute error &lt; 7.6e-15</code></pre>
<pre class="r"><code>integrate(fn, mu = 100, sigma = 10, lower = 95, upper = +Inf)</code></pre>
<pre><code>## 0.6914625 with absolute error &lt; 8.1e-05</code></pre>
<p>e os resultados acima evidentemente coincidem com os obtidos anterioriormente usando <code>pnorm()</code>,</p>
<pre class="r"><code>pnorm(110, 100, 10) - pnorm(90, 100, 10)</code></pre>
<pre><code>## [1] 0.6826895</code></pre>
<pre class="r"><code>pnorm(95, 100, 10, lower.tail = FALSE)</code></pre>
<pre><code>## [1] 0.6914625</code></pre>
<p>Note ainda que na prática não precisamos definir e usar a função <code>fn()</code>, pois ela fornece o mesmo resultado que a função <code>dnorm()</code>.</p>
</div>
</div>
<div id="exercicios" class="section level2">
<h2>Exercícios</h2>
<p>Nos exercícios abaixo iremos também usar o R como uma calculadora estatística para resolver alguns exemplos/exercícios de probabilidade tipicamente apresentados em um curso de estatística básica.</p>
<ol style="list-style-type: decimal">
<li>Para <span class="math inline">\(X \sim N(90, 100)\)</span>, obtenha:
<ol style="list-style-type: lower-alpha">
<li><span class="math inline">\(P(X \leq 115)\)</span></li>
<li><span class="math inline">\(P(X \geq 80)\)</span></li>
<li><span class="math inline">\(P(X \leq 75)\)</span></li>
<li><span class="math inline">\(P(85 \leq X \leq 110)\)</span> <!-- e. $P(|X - 90| \leq 10)$ --> <!-- f. O valor de $a$ tal que $P(90-a \leq X \leq 90+a) = \gamma, \; --> <!-- \gamma=0.95$ --></li>
</ol></li>
<li>Sendo <span class="math inline">\(X\)</span> uma variável seguindo o modelo Binomial com parâmetros <span class="math inline">\(n = 15\)</span> e <span class="math inline">\(p = 0.4\)</span>, pergunta-se:
<ol style="list-style-type: lower-alpha">
<li><span class="math inline">\(P(X \geq 14)\)</span></li>
<li><span class="math inline">\(P(8 &lt; X \leq 10)\)</span> <!-- c. $P(X < 2 \; \mbox{ ou } \;\; X \geq 11)$ --> <!-- d. $P(X \geq 11 \;  \mbox{ ou } \;\; X > 13)$ --> <!-- e. $P(X > 3 \;  \mbox{ e } \;\; X < 6)$ --> <!-- f. $P(X \leq 13 \; | \; X \geq 11)$ --></li>
</ol></li>
<li>Uma empresa informa que 30% de suas contas a receber de outras empresas encontram-se vencidas. Se o contador da empresa seleciona aleatoriamente 5 contas, determine a probabilidade de:
<ol style="list-style-type: lower-alpha">
<li>Nenhuma conta estar vencida</li>
<li>Exatamente duas contas estarem vencidas</li>
<li>Três ou mais contas estarem vencidas</li>
</ol></li>
<li>Uma empresa recebe 720 emails em um intervalo de 8 horas. Qual a probabilidade de que:
<ol style="list-style-type: lower-alpha">
<li>Em 6 minutos receba pelo menos 3 emails?</li>
<li>Em 4 minutos não receba nenhum email?</li>
</ol></li>
<li>O processo de empacotamento de uma fábrica de cereais foi ajustado de maneira que uma média de <span class="math inline">\(\mu = 13,0\)</span> kg de cereal seja colocado em cada caixa. Sabe-se que existe uma pequena variabilidade no enchimento dos pacotes devido à fatores aleatórios, e que o desvio-padrão do peso de enchimento é de <span class="math inline">\(\sigma = 0,1\)</span> kg. Assume-se que a distribuição dos pesos tem distribuição normal. Com isso, determine as probabilidades de que uma caixa escolhida ao acaso:
<ol style="list-style-type: lower-alpha">
<li>Pese entre 13,0 e 13,2 kg.</li>
<li>Tenha um peso maior do que 13,25 kg.</li>
<li>Pese entre 12,8 e 13,1 kg.</li>
<li>Pese entre 13,1 e 13,2 kg.</li>
</ol></li>
<li>Faça os seguintes gráficos:
<ol style="list-style-type: lower-alpha">
<li>da função de densidade de uma variável com distribuição de Poisson com parâmetro <span class="math inline">\(\lambda = 5\)</span></li>
<li>da densidade de uma variável <span class="math inline">\(X \sim N(90, 100)\)</span></li>
<li>sobreponha ao gráfico anterior a densidade de uma variável <span class="math inline">\(Y \sim N(90, 80)\)</span> e outra <span class="math inline">\(Z \sim N(85, 100)\)</span></li>
<li>densidades de distribuições <span class="math inline">\(\chi^2\)</span> com 1, 2 e 5 graus de liberdade.</li>
</ol></li>
</ol>
<!-- Referencias -->
</div>
</div>

<center>
  <hr width="100%" size="3px">
  <p> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.pt_BR">
      <img src="img/CC_by-nc-sa_80x15.png" alt="Licença Creative Commons 4.0"> </a>
  </p>
  <p> <font size="2"> Este conteúdo
      está disponível por meio da Licença Creative Commons 4.0 </font>
  </p>
</center>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
